<!DOCTYPE HTML>
<html lang="en">

<head>
	<title>three.js - geometry - cube</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
	<style type="text/css">
		body {
			font-family: Monospace;
			background-color: #ffffff;
			margin: 0px;
			overflow: hidden;
		}
	</style>
</head>

<body>

	<!-- <script type="text/javascript" src="../../build/three.js"></script> -->

	<script src="../../src/Class.js"></script>


	<script src="../../src/core/Color.js"></script>
	<script src="../../src/core/Vector2.js"></script>
	<script src="../../src/core/Vector3.js"></script>
	<script src="../../src/core/Vertex.js"></script>
	<script src="../../src/core/Face3.js"></script>
	<script src="../../src/core/Face4.js"></script>
	<script src="../../src/core/Geometry.js"></script>
	<script src="../../src/core/Matrix3.js"></script>
	<script src="../../src/core/Matrix4.js"></script>



	<script src="../../src/cameras/Camera.js"></script>

	<script src="../../src/materials/ColorMaterial.js"></script>
	<script src="../../src/materials/FaceColorMaterial.js"></script>

	<script src="../../src/objects/Object3D.js"></script>
	<script src="../../src/objects/Mesh.js"></script>
	<script src="../../src/objects/Particle.js"></script>
	<script src="../../src/objects/primitives/Cube.js"></script>
	<script src="../../src/objects/primitives/Plane.js"></script>

	
	<script src="../../src/renderers/Renderer.js"></script>
	<script src="../../src/renderers/CanvasRenderer.js"></script>
	<script src="../../src/renderers/SVGRenderer.js"></script>

	<script src="../../src/scenes/Scene.js"></script>


	<!-- <script type="text/javascript" src="http://github.com/mrdoob/stats.js/raw/master/build/stats.js"></script> -->

	<script type="text/javascript">

		var SCREEN_WIDTH = window.innerWidth;
		var SCREEN_HEIGHT = window.innerHeight;

		var container;
		var stats;

		var camera;
		var scene;
		var renderer;

		var cube, plane;

		var targetRotation = 0;
		var targetRotationOnMouseDown = 0;

		var mouseX = 0;
		var mouseXOnMouseDown = 0;

		var windowHalfX = window.innerWidth / 2;
		var windowHalfY = window.innerHeight / 2;

		init();
		setInterval(loop, 1000 / 60);

		function init() {
			container = document.createElement('div');
			document.body.appendChild(container);

			var info = document.createElement('div');
			info.style.position = 'absolute';
			info.style.top = '10px';
			info.style.width = '100%';
			info.style.textAlign = 'center';
			info.innerHTML = 'Drag to spin the cube';
			container.appendChild(info);

			camera = new Camera(0, 150, 400);
			camera.focus = 300;
			camera.target.y = 150;
			camera.updateMatrix();

			scene = new Scene();

			// Cube

			geometry = new Cube(200, 200, 200);

			for (var i = 0; i < geometry.faces.length; i++)
				geometry.faces[i].color.setRGBA(Math.floor(Math.random() * 128), Math.floor(Math.random() * 128 + 128), Math.floor(Math.random() * 128 + 128), 255);

			cube = new Mesh(geometry, new FaceColorMaterial());
			cube.position.y = 150;
			cube.updateMatrix();
			scene.add(cube);

			// Plane

			plane = new Mesh(new Plane(200, 200), new ColorMaterial(0xeeeeee));
			plane.rotation.x = 90 * (Math.PI / 180);
			plane.updateMatrix();
			scene.add(plane);

			renderer = new CanvasRenderer();
			renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);

			container.appendChild(renderer.viewport);

			// stats = new Stats();
			// container.appendChild(stats.getDisplayElement());

			document.addEventListener('mousedown', onDocumentMouseDown, false);
			document.addEventListener('touchstart', onDocumentTouchStart, false);
			document.addEventListener('touchmove', onDocumentTouchMove, false);
		}

		//

		function onDocumentMouseDown(event) {
			event.preventDefault();

			document.addEventListener('mousemove', onDocumentMouseMove, false);
			document.addEventListener('mouseup', onDocumentMouseUp, false);

			mouseXOnMouseDown = event.clientX - windowHalfX;
			targetRotationOnMouseDown = targetRotation;
		}

		function onDocumentMouseMove(event) {
			mouseX = event.clientX - windowHalfX;

			targetRotation = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.05;
		}

		function onDocumentMouseUp(event) {
			document.removeEventListener('mousemove', onDocumentMouseMove, false);
			document.removeEventListener('mouseup', onDocumentMouseUp, false);
		}

		function onDocumentTouchStart(event) {
			if (event.touches.length == 1) {
				event.preventDefault();

				mouseXOnMouseDown = event.touches[0].pageX - windowHalfX;
				targetRotationOnMouseDown = targetRotation;
			}
		}

		function onDocumentTouchMove(event) {
			if (event.touches.length == 1) {
				event.preventDefault();

				mouseX = event.touches[0].pageX - windowHalfX;
				targetRotation = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.05;
			}
		}

		//

		function loop() {
			cube.rotation.y += (targetRotation - cube.rotation.y) * 0.05;
			cube.updateMatrix();

			plane.rotation.z = -cube.rotation.y;
			plane.updateMatrix();

			renderer.render(scene, camera);
			// stats.update();
		}

	</script>

</body>

</html>